"use strict";console.log(">> Ready :)");const listDrink=document.querySelector(".js-list"),listDrinkFav=document.querySelector(".js-list-fav"),inputName=document.querySelector(".js-input-name"),searchButton=document.querySelector(".js-button-search"),resetButton=document.querySelector(".js-button-reset"),resetButtonFav=document.querySelector(".js-reset-fav"),msgErrorSearch=document.querySelector(".js-msg-error");let drinkDataList=[],favorites=[];function setInLocalStorage(){const e=JSON.stringify(favorites);localStorage.setItem("favorites",e)}function getDrinks(e){if(e.preventDefault(),drinkDataList=[],listDrink.innerHTML="",msgErrorSearch.innerHTML="",""===inputName.value)msgErrorSearch.innerHTML="Debe rellenar el buscador";else{const e="https://www.thecocktaildb.com/api/json/v1/1/search.php?s="+inputName.value;console.log("serverurl: "+e),fetch(e).then(e=>e.json()).then(e=>{console.log(e),drinkDataList=e.drinks,renderDrinksList(drinkDataList)}).catch(e=>{msgErrorSearch.innerHTML="Este cocktail no estÃ¡ en el listado"})}}function renderDrink(e){null===e.strDrinkThumb&&(e.strDrinkThumb="https://via.placeholder.com/210x295/ffffff/666666/?text=drink");let t="";-1!==favorites.findIndex(t=>t.idDrink===e.idDrink)&&(t="favorite");return`<li class="list__container--item ${t} js-drink-item" id="${e.idDrink}">  \n  <img class="list__container--img" src=${e.strDrinkThumb} alt="Foto de ${e.strDrink}" />\n  <p class="list__container--name">${e.strDrink}</p>\n </li>`}function renderDrinksList(e){listDrink.innerHTML="",console.log(e);for(const t of e)listDrink.innerHTML+=renderDrink(t);const t=document.querySelectorAll(".js-drink-item");for(const e of t)e.addEventListener("click",handleClicDrink)}function renderDrinkFavorite(e){null===e.strDrinkThumb&&(e.strDrinkThumb="https://via.placeholder.com/210x295/ffffff/666666/?text=drink");return`<li class="fav__container--item js-drink-fav" id="${e.idDrink}"> \n  <img class="fav__container--img" src=${e.strDrinkThumb} alt="Foto de ${e.strDrink}" />\n  <p class="fav__container--name">${e.strDrink}</p>\n  <button class="fav__container--btndelete js-delete-fav" id="${e.idDrink}"><i class="icon fas fa-times"></i></button>\n  </li>`}function renderDrinksFavoriteList(e){console.log(e),listDrinkFav.innerHTML="";for(const t of e)listDrinkFav.innerHTML+=renderDrinkFavorite(t);e.length>0?(document.querySelector(".js-msg-fav").classList.add("hidden"),resetButtonFav.classList.remove("hidden")):(document.querySelector(".js-msg-fav").classList.remove("hidden"),resetButtonFav.classList.add("hidden"));const t=document.querySelectorAll(".js-delete-fav");for(const e of t)e.addEventListener("click",handleClicDeleteFav);setInLocalStorage()}function handleClicDrink(e){e.preventDefault();const t=e.currentTarget;console.log("Este es el id seleccionado: "+t.id);const n=favorites.findIndex(e=>e.idDrink===t.id);if(console.log("drinkFoundIndex:"+n),-1!==n)favorites.splice(n,1),t.classList.remove("favorite");else{const e=drinkDataList.find(e=>e.idDrink===t.id);favorites.push(e),t.classList.add("favorite")}console.log("list favorito:"+favorites),renderDrinksFavoriteList(favorites)}function handleClicDeleteFav(e){e.preventDefault();const t=e.currentTarget,n=favorites.findIndex(e=>e.idDrink===t.id);favorites.splice(n,1),renderDrinksList(drinkDataList),renderDrinksFavoriteList(favorites)}function handleReset(e){e.preventDefault(),drinkDataList=[],listDrink.innerHTML="",msgErrorSearch.innerHTML="",inputName.value=""}function ResetListFav(e){e.preventDefault(),favorites.splice(0),renderDrinksList(drinkDataList),renderDrinksFavoriteList(favorites)}function getLocalStorage(){const e=localStorage.getItem("favorites");if(null===e)getDrinks();else{const t=JSON.parse(e);favorites=t,renderDrinksList(drinkDataList),renderDrinksFavoriteList(favorites)}}searchButton.addEventListener("click",getDrinks),resetButton.addEventListener("click",handleReset),resetButtonFav.addEventListener("click",ResetListFav),getLocalStorage();